@*
    For more information on enabling MVC for empty projects, visit http://go.microsoft.com/fwlink/?LinkID=397860
*@

@model POYA.Areas.EduHub.Models.EArticle

@{ 
    var IsEdit=(bool)ViewData["IsEdit"];
}

<hr />
<div class="row">
    <div class="col">
        <form asp-action='@(IsEdit?"Edit":"Create")' id="EArticles_Form">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input type="hidden" asp-for="Id" />
            <div class="form-group ">
                <div class="row">
                    <input asp-for="Title" class="form-control col offset-3 col-6" placeholder="@(Localizer["Title"])" />
                    @*
                        <a asp-action="GetSharedImages" asp-controller="LUserFiles" asp-area="XUserFile" target="ImageSelectTab" class="col  col-1 col-sm-3 LookForImageIcon">&#128443;</a>
                    *@
                </div>
                <span asp-validation-for="Title" class="text-danger"></span>
            </div>
            <div class="form-group">
                <div id="MenuToolbar" class="toolbar">
                </div>
                <div id="_ContentEditor" class="text">
                    <p>
                        @(Html.Raw(Model.Content))
                    </p>
                </div>
                @*<div id="_ContentEditor"></div>*@
                <input asp-for="Content" hidden />
                <span asp-validation-for="Content" class="text-danger"></span>
            </div>

            @*<partial name="_VideoSelectPartial" model="Model" />*@

            <div class="form-group">
                <a asp-action="Index" class="btn btn-outline-primary">&laquo; @Localizer["Back"]</a>
                <a class="btn btn-primary" id="EArticles_Form_Submit_A">@Localizer["Save"]</a>
            </div>
        </form>
    </div>
</div>

<script src="~/lib/jquery/dist/jquery.min.js"></script>
<script src="~/lib/wangEditor-3.1.1/release/wangEditor.min.js"></script>
<script>

    class _EditPartial_Data{
        /**
         * 
         * @@param {any} Editor - The Editor
         */
        ReadyEditor(Editor) {
            //  #region CONTENT_EDITOR

            //  #region MENU CONFIGURE
            Editor.customConfig.menus = [
                'head',
                'bold',
                'fontSize',
                'italic',
                'underline',
                'strikeThrough',
                'foreColor',
                'backColor',
                'link',
                'list',
                'justify',
                'quote',
                'emoticon',
                'image',
                'table',
                'code',
                'undo',
                'redo',
            ];
            //  #endregion 

            // #region  LANGUAGE CONFIGURE

            Editor.customConfig.lang = {

                "\u8bbe\u7f6e\u6807\u9898": "@(Localizer["Title"])",
                "\u6b63\u6587": "@(Localizer["Paragraph"])",
                "\u94fe\u63a5\u6587\u5b57": "@(Localizer["Link text"])",
                "\u56fe\u7247\u94fe\u63a5": "@(Localizer["Image link"])",
                "\u94fe\u63a5": "@(Localizer["Link"])",
                "\u4e0a\u4f20\u56fe\u7247": "@(Localizer["Upload image"])",
                "\u4e0a\u4f20": "@(Localizer["Upload"])",
                "\u521b\u5efa": "@(Localizer["Initial"])",
                "\u63d2\u5165\u4ee3\u7801": "@(Localizer["Insert code"])",
                "\u7f51\u7edc\u56fe\u7247": "@(Localizer["Image url"])",
                "\u63d2\u5165\u8868\u683c": "@(Localizer["Table"])",
                "\u884c": "@(Localizer["line"])",
                "\u5217\u7684\u8868\u683c": "@(Localizer["col"])",
                "\u63d2\u5165": "@(Localizer["Insert"])",
                "\u5bf9\u9f50\u65b9\u5f0f": "@(Localizer["Align"])",
                "\u5b57\u53f7": "@(Localizer["Font size"])",
                "\u5b57\u4f53": "@(Localizer["Font"])",
                "\u5b8b\u4f53": "@(Localizer["Simsun"])",
                "\u5fae\u8f6f\u96c5\u9ed1": "@(Localizer["Microsoft YaHei"])",
                "\u6587\u5b57\u989c\u8272": "@(Localizer["Font color"])",
                "\u80cc\u666f\u8272": "@(Localizer["background color"])",
                "\u8bbe\u7f6e\u5217\u8868": "@(Localizer["List"])",
                "\u6709\u5e8f\u5217\u8868": "@(Localizer["ordered list"])",
                "\u65e0\u5e8f\u5217\u8868": "@(Localizer["unordered list"])",
                "\u9760\u5de6": "@(Localizer["Left"])",
                "\u5c45\u4e2d": "@(Localizer["Center"])",
                "\u9760\u53f3": "@(Localizer["Right"])",
                "\u9ed8\u8ba4": "@(Localizer["Default"])",
                "\u65b0\u6d6a": "@(Localizer["Sina"])",

            };

            // #endregion

            //  #region UPLOAD IMAGE CONFIGURE
            Editor.customConfig.uploadImgServer = '@(Url.Action("UploadEArticleImage"))';
            Editor.customConfig.uploadImgMaxSize = 2 * 1024 * 1024;
            Editor.customConfig.uploadImgMaxLength = 8;
            Editor.customConfig.uploadImgHeaders = {
                "L-XSRF-TOKEN": "@(csrf.GetAndStoreTokens(Context).RequestToken)"
            };
            Editor.customConfig.uploadFileName = 'EArticleImages';
            //  #endregion


            Editor.create();
            @*Editor.txt.html('@(Html.Raw( Model.Content))');*@
            //  #endregion

        }
    }
    
    var _Editor = window.wangEditor;
    var Editor = new _Editor("#MenuToolbar","#_ContentEditor");

    var _EditPartial_Data_ =new _EditPartial_Data();

    $(document).ready(function () {

        _EditPartial_Data_.ReadyEditor(Editor);

        $("#EArticles_Form_Submit_A").on("click", function () {
            $("#Content").val(Editor.txt.html());
            $("#EArticles_Form").submit();
            event.preventDefault();
        });

        $("#_ContentEditor").on("click", function () {
            $(".w-e-text").focus();
        });
       
        /* 
         * $(".w-e-text").keyup(function () {
                window.scrollTo(0, document.documentElement.clientHeight);
        });


        $('..w-e-text').focus(function () { $('html,body').animate({ scrollTop: $('.bottom').offset().top }, 800); });
        $(".w-e-text").on("focus", function () {
            //  document.body.scrollTop =  document.body.scrollHeight;
            window.scrollTo(0, document.documentElement.clientHeight);
        });
        */
    });
</script>
<style>
    
        #Title {
            text-align: center;
        }

        #_ContentEditor{
            height:500px;
            border:dotted;
            border-radius:20px;
        }
        .w-e-text{
            overflow-y:scroll;

        }

        .w-e-toolbar {
            display: flex;
            flex-wrap: wrap;
        }
        .LookForImageIcon{
            zoom:200%;
        }
</style>